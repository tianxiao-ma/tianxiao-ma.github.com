---
title: 什么是数字签名与数字证书
layout: post
permalink: /2013/02/what_is_digital_siganature_and_certificate/
date: Mon Feb 04 18:30:00 pm GMT+8 2013
published: true
---

1. 数字签名
----------------
数字签名的概念类似于平时我们的手写的签名，在欧美已经被认为是具有法律效力的身份标识。数字签名利用了[非对称加密技术](http://en.wikipedia.org/wiki/Public-key_cryptography)来为网络上传送的数据打上个人的身份标识。

### 1.1. 公钥与私钥
使用*非对称加密技术*进行通信的每一方都会拥有两把钥匙，分别成为*公钥*和*私钥*。这两把“钥匙”是非对称的，也就是说，利用其中的一把“钥匙”是无法制造出另外一把“钥匙”的。因此，将任何一把“钥匙”泄露到网络上是不会造成任何问题的，通常我们会将“公钥”放到网络上，而“私钥”则保存在本地，不让任何人知道。

假设现在李磊要传送数据给韩梅梅，李磊会从网络上获取韩梅梅的“公钥”，然后用韩梅梅的“公钥”对要发送的数据进行加密，然后将加密之后的数据发送给韩梅梅。韩梅梅在收到加密数据之后，就可以利用自己的私钥将这些数据进行解密，然后就能正常看到这些数据了。由于解密需要的“私钥”只有韩梅梅一个人有，因此这些加密的数据其他任何人都是无法解密的(姑且可以这么认为)，这样就可以保证数据传送的安全性。

### 1.2. 数字签名的作用
由于“公钥”是所有人都可以拿到的，这样就存在一个问题，韩梅梅怎么知道李磊发送给她的信息就一定真的是李磊发过来的呢？这个时候数字签名就派上用场了，李磊可以为他发送的信息进行签名，表明这个信息就是他自己发送的，那么数字签名是如何工作的呢？

首先，李磊会利用一些软件为他要发送的信息生成一个摘要，目前普遍使用hash算法来生成这个摘要，这类算法叫做[哈希加密算法(Cryptographic hash function)](http://en.wikipedia.org/wiki/Cryptographic_hash_function)，[MD5](http://en.wikipedia.org/wiki/MD5)、[SHA](http://en.wikipedia.org/wiki/SHA-1)都属于这种算法。他们的特点是不可逆，也就是信息一旦被加密，是无法被还原的。

摘要生成之后，李磊会用自己的“私钥”对这个信息进行加密。由于李磊的“私钥”只有李磊自己有，这样就可以确认消息的来源了。李磊的客户端软件会将这段加密之后的摘要附加到真正要发送的消息(消息是经过韩梅梅的公钥加密的)后面，然后一同发给韩梅梅。

韩梅梅在接收到消息之后，就可以使用李磊放在消息中的摘要来确认消息是不是真的是李磊发送的。首先，韩梅梅会使用李磊的公钥来解密摘要(不错，“公钥”是可以用来解密“私钥”加密之后的信息的)，如果能够正常解密，那么韩梅梅就能够获得摘要的真实内容。之后韩梅梅会利用相同的*哈希加密算法*对消息内容进行一次计算，从而得到一个新的摘要。最后，将这两个摘要信息进行对比，如果两者一模一样，说明消息在发送过程中没有丢失信息或者被恶意修改，这样韩梅梅就可以放心读取这个消息了。

2. 数字证书
-----------------
前面说道的“公钥”和“私钥”是通过一些个人信息、组织信息还有其他一些信息生成的，那么就会有一个问题，通过提供同样的信息，“公钥”和“私钥”是可以被伪造的。假设李磊的“公钥”和“私钥”的生成过程中，使用了他的名字和邮箱地址，那么通过相同的信息，我们是可以生成一模一样的“公钥”与“私钥”的。数字证书就是用来防止这种情况发生的。

数字证书是由[证书委员为(Certificate authority)](http://en.wikipedia.org/wiki/Certificate_authority)，通常都是一些受信的第三方公司或者组织颁发的。我们需要向这些组织或者机构申请获得证书，在申请时提供自己的相关信息，比如姓名、邮箱、地址、电话等等，*CA*检查通过了这些信息之后，就会颁发证书。证书中不仅包含了申请者的相关信息，还会包含申请者的“公钥”以及*CA*使用自己的私钥加密过的消息摘要。这个消息摘要与数字签名中的摘要有所不同，其中会包含一些信息，比如证书所有者的姓名、邮箱等，这些信息会被消息的接收方用来检查证书的可靠性。由于*CA*的私钥是不可能被任何人伪造的，这样就可以保证证书的可靠性，进而保证消息的可靠性。

在使用数字证书的情况下，如果李磊传送消息给韩梅梅，那么被传送的除了经过加密之后的消息、数字签名之外，还会有一个李磊的数字证书。当韩梅梅收到消息之后，首先会使用*CA*的公钥对包含在数字证书中的摘要信息进行解密，如果能够成功解密，而且摘要中的个人信息与证书中的个人信息是一致的，那么就可以确认消息是从李磊那里发出来的。之后再经过数字签名检查、消息解密之后，读取消息的内容，此时可以认为这个消息是由李磊发出来的，并且中途没有丢失内容或者被人恶意修改过。
